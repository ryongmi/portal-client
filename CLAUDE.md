# CLAUDE.md

이 파일은 이 저장소의 코드 작업 시 Claude Code (claude.ai/code)에게 지침을 제공합니다.

## 개발 명령어

- `npm run dev` - 개발 서버 시작
- `npm run build` - 프로덕션 빌드
- `npm run start` - 프로덕션 서버 시작
- `npm run lint` - ESLint 실행
- `npm run type-check` - 파일 출력 없이 TypeScript 타입 검사 실행

## 아키텍처 개요

이 애플리케이션은 KRGeobuk 서비스 생태계를 위한 통합 포탈 클라이언트입니다. Next.js 15로 구축된 현대적인 웹 애플리케이션으로, 완전한 사용자 인증 시스템, 고급 관리자 인터페이스, 그리고 반응형 사용자 경험을 제공합니다.

### 주요 아키텍처 구성 요소

**프론트엔드 구조:**
- Next.js 15 App Router로 구축
- 엄격 모드가 활성화된 TypeScript
- Tailwind CSS를 사용한 현대적인 UI/UX 디자인
- React Hook Form을 활용한 폼 관리
- 경로 별칭 설정 (`@/*` → `./src/*`)
- 커스텀 ESLint 설정으로 코드 품질 관리

**서비스 아키텍처:**
이 애플리케이션은 3개의 주요 서비스로 구성된 마이크로서비스 생태계를 관리하도록 설계되었습니다:
1. **인증 서비스** (`auth-service`) - 사용자 인증 및 OAuth 관리
2. **인가 서비스** (`authz-service`) - 역할 및 권한 관리
3. **포탈 서비스** (`portal-service`) - 서비스 통합 및 포탈 관리

**데이터 모델:**
핵심 엔티티는 User, Role, Permission, Service, UserRole, RolePermission, ServiceVisibleRole이며 `src/types/`에서 적절한 TypeScript 인터페이스로 정의됩니다.

**관리자 인터페이스:**
`/admin` 라우트 하위에 위치하며 다음과 같은 중첩 페이지들을 포함합니다:
- 사용자 관리 (`/admin/auth/users`)
- OAuth 클라이언트 관리 (`/admin/auth/oauth`)
- 역할 관리 (`/admin/authorization/roles`)
- 권한 관리 (`/admin/authorization/permissions`)
- 서비스 관리 (`/admin/portal/services`)

**인증 시스템:**
완전한 사용자 인증 플로우가 구현되어 있습니다:
- 로그인 페이지 (`/auth/login`) - 이메일/비밀번호 인증, 폼 검증, 로딩 상태
- 회원가입 페이지 (`/auth/register`) - 확장된 사용자 정보 입력, 약관 동의, 비밀번호 확인
- 모든 폼에 클라이언트 사이드 검증 및 에러 처리 포함

**컴포넌트 구조:**
- `src/components/common/` - 재사용 가능한 UI 컴포넌트
  - **Button**: 다양한 변형(primary, secondary, danger, outline)과 크기 옵션
  - **EnhancedDetailModal**: 고급 상세보기 모달 (필드 타입별 렌더링, 커스텀 색상)
  - **Table, Pagination, SearchFilters**: 데이터 표시 및 관리 컴포넌트
- `src/components/layout/` - 레이아웃 컴포넌트
  - **Layout**: 반응형 레이아웃 wrapper
  - **Header**: 사용자 메뉴가 포함된 네비게이션 헤더
  - **Sidebar**: 접을 수 있는 관리자 사이드바
- `src/components/forms/` - 폼 컴포넌트
  - **RoleForm**: 탭 기반 역할 관리 폼 (기본 정보 + 권한 설정)
  - **PermissionForm**: 권한 생성 및 편집 폼
- `src/hooks/` - 커스텀 훅
  - **usePagination**: 페이지네이션, 정렬, 필터링 관리

**현대적인 UI/UX:**
- 그라데이션 배경과 글래스모피즘 효과
- 호버 애니메이션과 마이크로 인터랙션
- 반응형 디자인 (모바일 우선 접근법)
- 접근성 고려 (포커스 상태, 키보드 네비게이션)
- 밝고 현대적인 색상 테마

**목 데이터:**
개발/테스트 목적으로 `src/data/mockData.ts`에서 포괄적인 목 데이터를 제공합니다.

## 개발 참고사항

**언어:** 애플리케이션에는 한국어 지원이 내장되어 있습니다 (루트 레이아웃에서 lang="ko")

**스타일링 시스템:**
- **Tailwind CSS**: 유틸리티 우선 CSS 프레임워크
- **그라데이션 테마**: `from-blue-50 via-indigo-50 to-purple-50` 등 밝은 색상 체계
- **글래스모피즘 효과**: `backdrop-blur-sm`, `bg-white/90` 등의 투명도 효과
- **반응형 디자인**: 모든 컴포넌트가 모바일 우선으로 설계됨
- **다크 모드 준비**: CSS 변수 기반 색상 시스템

**타입 안전성:**
- **완전한 TypeScript 지원**: 모든 컴포넌트와 함수가 엄격하게 타입화됨
- **인터페이스 정의**: `src/types/index.ts`에서 모든 데이터 모델 정의
- **프롭 타입**: 모든 컴포넌트 props가 명시적으로 타입 정의됨
- **제네릭 활용**: 재사용 가능한 컴포넌트에서 타입 매개변수 사용

**폼 관리:**
- **React Hook Form**: 모든 폼에서 성능 최적화된 폼 관리
- **실시간 검증**: 사용자 입력 시 즉시 에러 상태 업데이트
- **에러 처리**: 필드별 에러 메시지와 시각적 피드백
- **제출 상태**: 로딩 상태와 비활성화 상태 관리

**상태 관리:**
- **로컬 상태**: React hooks(useState, useEffect)를 활용한 컴포넌트 상태 관리
- **폼 상태**: React Hook Form을 통한 폼 상태 관리
- **UI 상태**: 모달, 드롭다운, 사이드바 등의 UI 상태 관리

**서비스 가시성 관리:**
서비스는 두 가지 플래그를 통해 포탈에서의 가시성을 제어합니다:
- `isVisible`: 포탈에서 표시 여부
- `isVisibleByRole`: 권한 기반 표시 여부

가시성 조건:
- **비공개** (`isVisible = false`): 관리자만 볼 수 있음, 포탈 사용자는 접근 불가
- **공개** (`isVisible = true && isVisibleByRole = false`): 모든 포탈 사용자가 접근 가능
- **권한 기반** (`isVisible = true && isVisibleByRole = true`): 특정 역할을 가진 사용자만 접근 가능

**관리자 인터페이스 특징:**
- **분리된 모달 시스템**: 각 기능별로 독립적인 모달 (수정, 권한 설정, 상세보기)
- **고급 데이터 표시**: EnhancedDetailModal을 통한 구조화된 정보 표시
- **실시간 검색 및 필터링**: 모든 목록 페이지에서 즉시 검색 기능
- **페이지네이션**: 대용량 데이터 처리를 위한 효율적인 페이지네이션
- **역할 개수 표시**: 사용자 목록에서 각 사용자의 역할 개수만 간략 표시

**사용자 경험 개선사항:**
- **메인 페이지**: 현대적인 랜딩 페이지 디자인, 서비스 카드 호버 효과
- **사용자 메뉴**: 헤더에 드롭다운 사용자 메뉴 (프로필, 설정, 로그아웃)
- **접을 수 있는 사이드바**: 관리자 인터페이스의 공간 효율성
- **로딩 상태**: 모든 비동기 작업에 시각적 피드백
- **에러 핸들링**: 사용자 친화적인 에러 메시지와 복구 안내

**중간 테이블 관리:**
각 주 엔티티 페이지에 관련 관계 관리가 통합되어 있습니다:
- **사용자 관리**: 역할 할당 및 상세 정보 조회
- **역할 관리**: 기본 정보 수정과 권한 설정이 별도 모달로 분리
- **서비스 관리**: 가시성 설정 및 권한 기반 접근 제어

**성능 최적화:**
- **메모이제이션**: usePagination 훅에서 불필요한 재렌더링 방지
- **지연 로딩**: 모달과 드롭다운의 조건부 렌더링
- **최적화된 이미지**: Next.js Image 컴포넌트 활용 준비
- **번들 크기 최적화**: 트리 셰이킹과 동적 import 활용

## API 응답 포맷
백엔드 API와의 통신 시 사용되는 응답 포맷 표준은 메인 CLAUDE.md의 "API 응답 포맷 표준" 섹션을 참조하세요.